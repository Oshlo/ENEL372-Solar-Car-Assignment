Version 4
SHEET 1 1760 1020
WIRE -208 -432 -304 -432
WIRE -32 -432 -208 -432
WIRE 48 -432 -32 -432
WIRE 160 -432 112 -432
WIRE 288 -432 240 -432
WIRE -304 -400 -304 -432
WIRE -208 -400 -208 -432
WIRE -32 -400 -32 -432
WIRE -304 -288 -304 -320
WIRE -208 -288 -208 -336
WIRE -208 -288 -304 -288
WIRE -32 -288 -32 -320
WIRE -32 -288 -208 -288
WIRE 288 -288 -32 -288
WIRE -864 -16 -864 -32
WIRE -48 48 -80 48
WIRE 208 48 96 48
WIRE 272 48 208 48
WIRE -48 80 -272 80
WIRE 208 80 208 48
WIRE 208 80 96 80
WIRE 912 96 912 80
WIRE 912 96 832 96
WIRE 992 96 912 96
WIRE -864 112 -864 64
WIRE -784 112 -864 112
WIRE -48 112 -176 112
WIRE 400 112 96 112
WIRE 512 112 400 112
WIRE 592 112 512 112
WIRE 704 112 656 112
WIRE 832 112 832 96
WIRE -864 128 -864 112
WIRE 992 128 992 96
WIRE -448 144 -496 144
WIRE -336 144 -336 80
WIRE -336 144 -368 144
WIRE -48 144 -336 144
WIRE 320 144 96 144
WIRE 768 160 736 160
WIRE -48 176 -160 176
WIRE 256 176 96 176
WIRE 320 176 320 144
WIRE 400 176 400 112
WIRE -160 208 -160 176
WIRE -48 208 -160 208
WIRE 144 208 96 208
WIRE 256 208 256 176
WIRE -864 224 -864 208
WIRE 512 224 512 112
WIRE 592 224 512 224
WIRE 704 224 704 112
WIRE 704 224 672 224
WIRE 736 224 736 160
WIRE 736 224 704 224
WIRE 832 224 832 208
WIRE 1088 224 832 224
WIRE 1232 224 1168 224
WIRE -160 240 -160 208
WIRE -48 240 -160 240
WIRE 192 240 96 240
WIRE 832 240 832 224
WIRE -160 272 -160 240
WIRE 736 288 736 224
WIRE 768 288 736 288
WIRE 192 320 192 240
WIRE 256 320 256 272
WIRE 256 320 192 320
WIRE 320 320 320 256
WIRE 320 320 256 320
WIRE 400 320 400 256
WIRE 400 320 320 320
WIRE 192 336 192 320
WIRE 832 352 832 336
WIRE 912 352 832 352
WIRE 992 352 992 192
WIRE 992 352 912 352
WIRE 912 368 912 352
WIRE -144 624 -272 624
WIRE 160 624 -144 624
WIRE 288 624 160 624
WIRE 432 624 368 624
WIRE 560 624 432 624
WIRE 656 624 560 624
WIRE -16 672 -48 672
WIRE 160 672 160 624
WIRE 160 672 48 672
WIRE 160 704 160 672
WIRE 432 704 432 624
WIRE 560 704 560 624
WIRE -144 736 -144 624
WIRE -16 816 -16 800
WIRE -144 864 -144 800
WIRE -144 864 -272 864
WIRE -48 864 -48 672
WIRE -48 864 -144 864
WIRE -32 864 -48 864
WIRE 96 864 64 864
WIRE 160 864 160 768
WIRE 160 864 96 864
WIRE 432 864 432 768
WIRE 432 864 160 864
WIRE 560 864 560 784
WIRE 560 864 432 864
FLAG 192 336 0
FLAG -160 272 0
FLAG 272 48 Vpanel
FLAG 912 368 0
FLAG 912 80 Vpanel
FLAG 1232 224 Vgs
FLAG 656 624 Vout
FLAG -16 800 Vgs
FLAG 96 864 Vds
FLAG -272 624 Vpanel
FLAG -272 864 0
FLAG 144 208 5V
FLAG -80 48 0
FLAG -304 -288 0
FLAG 288 -432 Vpanel
FLAG -864 -32 Vpanel
FLAG -864 224 0
FLAG -784 112 Vmeas
FLAG -176 112 5V
FLAG -496 144 Vmeas
SYMBOL res 384 160 R0
SYMATTR InstName R4
SYMATTR Value 1.5k
SYMBOL res 304 160 R0
SYMATTR InstName R5
SYMATTR Value 2k
SYMBOL cap 240 208 R0
SYMATTR InstName C1
SYMATTR Value 0.01µ
SYMBOL AutoGenerated\\TL494_CEH 16 144 R0
SYMATTR InstName U1
SYMBOL npn 768 112 R0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL pnp 768 336 M180
SYMATTR InstName Q2
SYMATTR Value 2N3906
SYMBOL res 576 240 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R3
SYMATTR Value 1.5k
SYMBOL cap 976 128 R0
SYMATTR InstName C2
SYMATTR Value 1n
SYMBOL res 1184 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 15
SYMBOL cap -160 736 R0
SYMATTR InstName C3
SYMATTR Value 80µ
SYMBOL schottky 176 768 R180
WINDOW 0 24 64 Left 2
WINDOW 3 -118 63 Left 2
SYMATTR InstName D1
SYMATTR Value RB050L-40
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL nmos 64 816 R90
SYMATTR InstName M1
SYMATTR Value IPP034N03L
SYMBOL ind 272 640 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 330µ
SYMBOL schottky 656 96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMATTR Value RB050L-40
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res -48 -416 R0
SYMATTR InstName R8
SYMATTR Value 1000
SYMBOL diode -224 -400 R0
SYMATTR InstName D3
SYMATTR Value D_solar
SYMBOL current -304 -320 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I1
SYMATTR Value {X}
SYMBOL res 256 -448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 0.001
SYMBOL diode 48 -416 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMBOL res -880 -32 R0
SYMATTR InstName R1
SYMATTR Value 200k
SYMBOL res -880 112 R0
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL cap -272 64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 1µ
SYMBOL res -352 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 33k
SYMBOL cap 48 656 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 1µ
SYMBOL cap 416 704 R0
SYMATTR InstName C5
SYMATTR Value 5µ
SYMBOL res 544 688 R0
SYMATTR InstName R7
SYMATTR Value 10
TEXT -1024 392 Left 2 !.tran 0 0.5s 1ms startup
TEXT -56 -80 Left 2 ;PWM Generation
TEXT 840 -32 Left 2 ;Driver Circuit
TEXT 104 504 Left 2 ;Buck Converter
TEXT -200 -496 Left 1 !.MODEL D_solar d\n+Ron 4.2 Vfwd {Y} epsilon 4.6
TEXT -432 -528 Left 2 !.param Y=15\n.param alpha=1\n.param X=alpha*0.6
TEXT -432 -592 Left 1 ;alpha=1 is a sunny day\nalpha=0.5 is a cloudy day\nY is max power pt (depends on temperature and illumination)
